<!DOCTYPE html>
<html>
    <head>
        <title>Games</title>
        <link rel="icon" href="/favicon.png">
        <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400..700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="/assets/text/css/wicons.css">
        <link rel="stylesheet" href="/assets/text/css/global.css">
        <script src="https://unpkg.com/typewriter-effect@latest/dist/core.js"></script>
        <script src="/assets/text/js/setnavandfooter.js"></script>
        <style>
            /* Scaling factor for better responsiveness */
            :root {
                --scale-factor: 1; /* Default scale */
                --font-size: calc(16px * var(--scale-factor));
                --image-size: calc(80px * var(--scale-factor));
                --button-size: calc(40px * var(--scale-factor));
            }

            /* Media query to adjust scale based on screen size */
            @media screen and (max-width: 800px) {
                :root {
                    --scale-factor: 0.9;
                }
            }

            @media screen and (max-width: 480px) {
                :root {
                    --scale-factor: 0.75;
                }
            }

            body {background: var(--background); margin: 0; font-family: "Inter"; color: var(--text); font-size: var(--font-size);}

            .wrap {height: 100vh; width: 100vw; background: var(--background); position: relative; display: flex; align-items: center; justify-content: flex-end; flex-direction: column; text-align: center;}
            .scroll {width: 75%; height: calc(100% - 130px); overflow-y: scroll; overflow-x: hidden; border-left: 1px solid #ffffff66; border-right: 1px solid #ffffff66;}
            .game {height: 100px; width: 100%; display: flex; align-items: center; border-bottom: 1px dashed var(--text-dull);}
            .game img {height: var(--image-size); width: var(--image-size); margin: 10px; border-radius: 8px; box-shadow: 0 0 8px currentColor;}
            .game p {margin: 0; font-size: 18px; font-weight: 400; text-shadow: 0 0 8px currentColor; text-align: left;}
            .game button {height: var(--button-size); width: 80px; background: var(--background-light); color: var(--text); border: none; margin-right: 10px; margin-left: auto; text-shadow: 0 0 4px currentColor; transition: text-shadow 0.2s ease-in-out;}
            .game button:hover {cursor: pointer; text-shadow: 0 0 15px currentColor;}
            .game button.disabled {background: var(--dark); color: var(--text-dull);}
            .game button.disabled:hover {cursor: default; background: var(--dark); text-shadow: 0 0 4px currentColor;}
            #searchbar {height: 30px; width: 60%; padding: 0 8px; margin-bottom: 10px; background: none; border: 2px solid var(--background-light); border-radius: 8px; color: var(--text); font-family: "Inter";}
            #searchbar:focus {outline: none; box-shadow: 0 0 8px var(--text-dull);}

            @media screen and (max-width: 8in) {
                #wr {font-size: 60px;}
            }
            @media screen and (max-width: 5in) {
                #wr {font-size: 35px;}
                .wrc {height: 300px;}
            }
        </style>
    </head>
    <body>
        <button id="smallnavbtn" onclick="toggleSideNav()"><i class="wicon wicon-bar-menu" id="snbtnsub"></i></button>
        <nav id="navm">
            <!-- js! -->
            
        </nav>
        <nav id="sidenav">
            <!-- js! -->
        </nav>

        <div class="wrap">
            <input placeholder="Search..." id="searchbar" type="text">
            <div class="scroll">
                <div class="game" data-name="1v1.lol">
                    <img src="/assets/image/game/1v1lol.png">
                    <p>1v1.lol</p>
                    <button onclick="launchGame('1v1.lol', '1v1lol')">Launch</button>
                </div>
                <div class="game" data-name="Snow Rider 3D">
                    <img src="/assets/image/game/snowrider3d.png">
                    <p>Snow Rider 3D</p>
                    <button onclick="launchGame('Snow Rider 3D', 'snowrider3d')">Launch</button>
                </div>
                <div class="game" data-name="Idle Breakout">
                    <img src="/assets/image/game/idlebreakout.png">
                    <p>Idle Breakout</p>
                    <button onclick="launchGame('Idle Breakout', 'idlebreakout')">Launch</button>
                </div>
                <div class="game" data-name="Bitlife Bit Life">
                    <img src="/assets/image/game/bitlife.png">
                    <p>Bitlife</p>
                    <button onclick="launchGame('Bitlife', 'bitlife')">Launch</button>
                </div>
                <a href="https://docs.google.com/forms/d/e/1FAIpQLSdPYkxyycGpLgrK4mE-xBtcjKkm6opMpZxyrKUQKU9PSv_6pw/viewform?usp=sf_link" style="color: var(--text); font-size: 13px;">Game Request Form</a>
                <br><span style="color: var(--text); font-size: 13px;">Joke requests will not be tolerated. Your future requests will be ignored.</span>
            </div>
        </div>

        <footer id="footer">
            <!-- js! -->
        </footer>

        <script>
            const searchbar = document.getElementById('searchbar');
            const games = document.getElementsByClassName('game');

            searchbar.addEventListener('input', (event) => {
                const query = event.target.value.toLowerCase();

                for (const game of games) {
                    const name = game.getAttribute('data-name').toLowerCase();
                    if (name.includes(query)) {
                        game.style.display = 'flex';
                    } else {
                        game.style.display = 'none';
                    }
                }
            });

            // Improved error handling and dynamic scaling on small devices
            function launchGame(name, id) {
                // Open a new blank tab
                const newTab = window.open('about:blank', '_blank');

                if (!newTab) {
                    alert("Failed to open a new tab. Please check your browser's pop-up blocker settings.");
                    return;
                }

                const loadingScreen = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>Loading ${name}</title>
                        <style>
                            body {
                                background: #101010;
                                color: #00ff00;
                                font-family: 'Pixelify Sans', sans-serif;
                                text-align: center;
                                margin-top: 20vh;
                            }
                        </style>
                    </head>
                    <body>
                        <h1>Loading ${name}...</h1>
                        <p>Please wait while we launch the game.</p>
                    </body>
                    </html>
                `;

                newTab.document.open();
                newTab.document.write(loadingScreen);
                newTab.document.close();

                // Redirect after a delay
                setTimeout(() => {
                    newTab.location.href = `/${id}`;
                }, 4000);
            }
        </script>
        <script src="/assets/text/js/global.js"></script>
    </body>
</html>
